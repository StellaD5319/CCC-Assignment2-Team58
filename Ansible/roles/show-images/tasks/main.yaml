---
# tasks file for show-images
# Show all available Openstack images
- name: Retrieve all available Openstack images
  #become: no
  os_image_info:
  #s_image_facts:
  #openstack.cloud.image_info:
  #  auth:
  #    auth_url: https://keystone.rc.nectar.org.au:5000/v3/
  #    username: y.sun74@student.unimelb.edu.au #Default
  #    password: OGU4NzU4NzM1MzYxMmI5
  #    project_name: unimelb-comp90024-2021-grp-58
  #openstack.cloud.image_info:
  register: image_result


- name: Get image names and Ids
  set_fact:
    image_facts: "{{ image_facts|default([]) + [ {'name': item.name, 'id': item.id} ] }}"
  loop: '{{ image_result.openstack_image }}'
  when: item.name is defined

- name: Show images 
  debug:
    msg: "Image name: {{ item.name }}; Image id: {{ item.id }}"
  loop: '{{ image_facts }}'